const bankUrl = "https://webapi.niftytrader.in/webapi/option/fatch-option-chain?symbol=banknifty&expiryDate="
const niftyUrl = "https://webapi.niftytrader.in/webapi/option/fatch-option-chain?symbol=nifty&expiryDate=";

async function getData() {
    const url = bankUrl
    try {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(`Response status: ${response.status}`);
      }
  
      const json = await response.json();
      console.log('getData => ', json);
    } catch (error) {
      console.error(error.message);
    }
  }

getData()




  
async function getData() {
  var jsonData;
    const url = "https://webapi.niftytrader.in/webapi/option/fatch-option-chain?symbol=nifty&expiryDate=";
    try {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(`Response status: ${response.status}`);
      }
      jsonData = await response.json();
      return jsonData
      
    } catch (error) {
      console.error(error.message);
    }
  }

function download(filename, text) {
      var element = document.createElement('a');
      element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
      element.setAttribute('download', filename);

      element.style.display = 'none';
      document.body.appendChild(element);

      element.click();

      document.body.removeChild(element);
    }

function triggerDataFetch() {
    var stringData = getData();
      stringData.then((data)=>{
        console.log('setTimeout stringData => ', data.resultData.opDatas);
        download("hello.txt", JSON.stringify(data.resultData.opDatas));
      })
}
setInterval(triggerDataFetch, 5000);